{"type":"javascript","name":"网页弹窗拦截","version":"1.0.0","tags":["工具脚本","其他脚本"],"synopsis":"弹窗次数过多时询问是否拦截某弹窗","source":" /*\n * @name: 网页弹窗拦截\n * @Author: undefined303（残月un）\n * @version: 1.0.0\n * @include: *\n */\n(function () {\n   'use strict';\nconst\nCONFIRM_COUNT = 5;\n/*当某弹窗弹出次数达到此值的倍数时，询问是否拦截*/\nconst ASK_IGNORE_COUNT = 3;\n/*当询问是否拦截次数达到该值的次数时，询问是否放行，填null则不会询问*/\nconst IGNORED_SITE =[];\n/*白名单网站：将网站完整地址或域名用\"\"包裹，并用英文逗号隔开\n示例：\n     单个网站\nconst IGNORED_SITE =[\"example.com\"]\n     多个网站\nconst IGNORED_SITE =[\"example1.com\",\"https://example2.com/example\"]\n*/\n/*****************以下勿改*****************/\nconst key = encodeURIComponent('网页弹窗拦截');\n  if (window[key]) {\n    return;\n  };\n  window[key] = true;\nIGNORED_SITE.forEach((item,index) =>{\ntry{\nIGNORED_SITE[index]=new URL(item).href\n}catch(e){/*ignore error*/}\n});\nif(!(IGNORED_SITE.indexOf(document.domain)!=-1||IGNORED_SITE.indexOf(location.href)!=-1)){\nconsole.log(\"启用网页弹窗拦截\")\nconst originalConfirm =window.confirm;\n[\"alert\", \"confirm\", \"prompt\"].forEach((method) => {\nlet count = 0;\nlet count_time = 1;\nlet ignore = false;\nlet ask=true;\nconst fn = window[method] ;\nwindow[method]=function(){\nif(ignore) {\nreturn undefined;\n}\nconst result = fn((arguments.length==0)?\"\":String(arguments[0]));\ncount++;\nif (count == CONFIRM_COUNT*count_time) {\nif(ask){\nignore = originalConfirm(\n`当前网页已弹出${method}弹窗${count}次，是否忽略后续该弹窗`);\n}\nif(ASK_IGNORE_COUNT!=null&&!ignore){\nif(count_time==ASK_IGNORE_COUNT&&originalConfirm(`是否本次放行本网站的${method}弹窗`)){\nask=false;\n}\n}\ncount_time++;\n}\nreturn result;\n};\n});\n}\n})();","detail":"<p>网页弹窗有三种：alert，confirm，prompt，分别为：警告框，确认框和输入框，有的网站会滥用这三种弹窗，给用户造成极大的干扰。</p><p>脚本预设参数<strong>CONFIRM_COUNT=5</strong></p><p>（可修改），当某类弹窗弹出次数达该参数的倍数时，询问是否拦截该类弹窗，拦截刷新解除。</p>","extra":{"xMetaComment":"// @run-at document-start"}}